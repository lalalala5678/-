# 智能电网调度推演系统 (Smart Grid Dispatch Simulation System)

这是一个基于 **React** (前端) 和 **Flask** (后端) 的全栈应用，旨在模拟和优化城市电网的应急电力车调度。系统利用 **高德地图 API** 进行地理空间可视化和真实路径规划，通过算法计算最优的车辆停靠位置，以最大程度降低断电风险。

## 核心功能

1.  **可视化地图交互**
    *   集成高德地图，提供灰度科技感底图。
    *   **雷达扫描特效**：叠加 Canvas 动态雷达扫描层，增强视觉体验。
    *   **热力图展示**：
        *   **断电风险热力图 (红色)**：展示城市中模拟的断电高风险区域。
        *   **电力支援热力图 (蓝/青色)**：展示当前电力车队覆盖的支援范围。
        *   支持图层开关控制。
    *   **交互式选点**：直接在地图上点击设定候选停车点 (P1, P2...)。

2.  **资源配置与管理**
    *   **批量添加车辆**：自定义单车载荷 (kW) 和数量，一键组建车队。
    *   **状态监控**：实时显示车辆总数、停车点状态（含停泊车辆数角标）。
    *   **悬停详情**：鼠标悬停在停车点上，可查看该点停靠的所有车辆详情 (ID, 载荷)。

3.  **智能调度算法 (Python)**
    *   **真实路网距离**：后端集成高德路径规划 API，计算车辆到高风险区的真实驾车距离（而非直线距离），确保调度方案具备现实可行性。
    *   **全局损失最小化**：采用迭代贪心策略，针对全局损失函数（Loss = $\sum(P_{outage} - P_{support})^2$）进行优化。
    *   **自动化部署**：一键运行算法，自动将空闲车辆分配到最优停车点，并更新支援热力图。

## 技术栈

*   **前端**: React 18, Vite, Tailwind CSS, Lucide React (图标), 高德地图 JS API (AMap)
*   **后端**: Python 3, Flask, NumPy, Requests (调用高德 Web 服务 API)
*   **算法**: 自定义贪心迭代优化算法, 距离衰减模型 ($e^{-x}$)

## 快速开始

### 1. 环境准备

*   Node.js (v16+)
*   Python (v3.8+)
*   高德地图 API Key (已内置或需申请)

### 2. 启动后端

```bash
# 根目录下
# 创建并激活虚拟环境 (推荐)
python -m venv .venv
.venv\Scripts\activate  # Windows
# source .venv/bin/activate # Mac/Linux

# 安装依赖
pip install -r requirements.txt

# 启动 Flask 服务
python app.py
```
后端默认运行在 `http://127.0.0.1:5000`。

### 3. 启动前端

```bash
cd frontend

# 安装依赖
npm install

# 启动开发服务器
npm run dev
```
前端默认运行在 `http://localhost:5173`。

## 使用指南

1.  **配置车队**：在左侧面板设定载荷和数量，点击“批量添加”。
2.  **设定停车点**：点击“开启选点模式”，在地图上选择若干个候选位置。
3.  **生成风险**：点击“模拟断电热力”，生成随机的城市断电风险分布。
4.  **运行调度**：点击“运行最优分配算法”。
5.  **观察结果**：
    *   观察停车点上的角标变化。
    *   查看蓝色支援热力图如何覆盖红色风险区。
    *   关注左侧面板的 "Loss Function" 数值变化（越小越好）。

## 许可证

MIT License
